local HttpService = game:GetService("HttpService")

local function SendLog(D)
    local webhookUrl = _G.AutofarmSettings.Webhook

    if webhookUrl and webhookUrl ~= "" then
        warn("Attempting to send log to webhook...")

        local data = {
            content = "",
            embeds = {{
                title = "**User Information**",
                description = string.format("**Username**: %s\n**UserID**: %s", D[1], tostring(D[2])),
                color = tonumber(0x2B6BE4),
                fields = {
                    {
                        name = "üí∞ Wallet",
                        value = tostring(D[3]),
                        inline = true
                    },
                    {
                        name = "üìà Profit",
                        value = tostring(D[4]),
                        inline = true
                    },
                    {
                        name = "‚úÖ Passed",
                        value = tostring(D[5]),
                        inline = true
                    },
                    {
                        name = "üèß ATMs",
                        value = tostring(D[6]),
                        inline = true
                    },
                    {
                        name = "ü§ñ Autofarm Status",
                        value = tostring(D[7]),
                        inline = false
                    },
                },
                footer = {
                    text = "Log generated by Autofarm System",
                    icon_url = "https://i.imgur.com/4M34hi2.png" -- Optional: Add a footer icon
                },
                image = {
                    url = "https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcSSPftv_Z5WcdPnpWCY6V4larYug-DjJtolZOvzARqenA&s"
                },
                timestamp = os.date("!%Y-%m-%dT%H:%M:%SZ")
            }}
        }

        local success, errorMessage = pcall(function()
            local httpRequest = http_request or (syn and syn.request)
            if httpRequest then
                httpRequest({
                    Url = webhookUrl,
                    Body = HttpService:JSONEncode(data),
                    Method = "POST",
                    Headers = {
                        ["Content-Type"] = "application/json"
                    }
                })
            else
                error("HTTP request function not found.")
            end
        end)

        if not success then
            warn("Error while sending log: " .. errorMessage)
        end
    else
        warn("Webhook URL is not set or is empty.")
    end
end

return SendLog
